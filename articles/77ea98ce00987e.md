---
title: "phpでフォームを作成する"
emoji: "💨"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["php"]
published: false
---


# フレームワークなしでフォームを作成する
この記事では、フレームワークなしでフォームを作成し、初心者の私が基礎的な知識を活用して簡単なフォームを作成していきます。


# XSS(クロスサイトスクリプティング)の防止
「値を受け取る」、「値を表示する」という基本的な機能から作成していきます。
しかし、安全に画面表示させる必要があるため、XSS対策を意識する必要があります。
https://grokipedia.com/page/Cross-site_scripting

つまり自分の腕部サイトに悪意のあるスクリプトが入力されて実行されてしまう可能性があるため、そこを考慮します。そのために、「htmlspecialchars」関数を使用します。

実際にコードを見ていきましょう。
```php
<?php 
    //ユーザーが入力した文字を表示する際に、スクリプトタグも文字として表示する関数
    //セキュリティリスクを低減させる
    //▼型宣言あり
    function h($char): string {
        return htmlspecialchars((string)$char,ENT_QUOTES, 'UTF-8');
    }

    //GETメソッドでインプットエリアから値を受け取り、
    //null合体演算子（＝inputに値が存在かつnullではない→空白を代入）
    $name = $_GET['input'] ?? '';
    //空白削除
    $name = trim($name);

?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <!-- ユーザーインプット -->
    <form method="get">
        <input name="input" value="<?= h($name)?>">
        <button type="submit">送信</button>
    </form>
    <!-- 出力 -->
    <p>こんにちは、<?= h($name) ?>さん</p>    
</body>
</html>
```
上記のコードでは型宣言を追加していますが、最もシンプルな形は以下のコードです。
```php
function h($char) {
    return htmlspecialchars($char, ENT_QUOTES, 'UTF-8');
}
```
この関数を使うことで、スクリプトなどのタグもただの文字列として表示されるのでスクリプトの実行を防いでくれます。


# 入力→表示まで
では、入力部分も作成していきます。
シンプルなフォームとして、入力欄と送信ボタンを用意します。
```php
<form method="get">
        <input name="input" value="<?= h($name)?>">
        <button type="submit">送信</button>
</form>
```
送信ボタンを押すと、同じformのvalueの値を送信します。

ボタンから送信があると、GETメソッドで送信内容を受け取ります。
```php
$name = $_GET['input'] ?? '';
$name = trim($name);
```
内容を受けとってname変数に格納したら、出力するだけです。
HTML内に「<?= ... ?>」でechoの省略形としてphpのコードを挿入することができます。

# まとめ
超簡単なフォームを作成することができました。
javascriptやcssを使うとさらに本格的なフォームになるので、また試してみたいと思います。
